[General]
allow-dns-svcb = false
# always-raw-tcp-hosts =
# always-raw-tcp-keywords =
always-real-ip = localhost, *.local, *.lan, *.direct, *.msftconnecttest.com, *.msftncsi.com, detectportal.firefox.com, injections.adguard.org, local.adguard.org, pool.ntp.org, *.pool.ntp.org, *.ntp.org.cn, stun.*, global.stun.twilio.com, global.turn.twilio.com, PDC._msDCS.*.*, DC._msDCS.*.*, GC._msDCS.*.*, cable.auth.com, network-test.debian.org, resolver1.opendns.com, ntp.*.com, ntp?.*.com, time.*.com, time?.*.com, time.*.edu.cn, time.*.gov, *.cmpassport.com, *.10099.com.cn, id6.me, open.e.189.cn, mdn.open.wo.cn, opencloud.wostore.cn, auth.wosms.cn, auth.wostore, *.jegotrip.com.cn, *.icitymobile.mobi, *.cmbchina.com, *.pingan.com.cn, localhost.*.qq.com, localhost.*.weixin.qq.com, *.douyinvod.com, *.douyinliving.com, *.amemv.com, *.douyincdn.com, *.live.bilibili.com, *.bilivideo.com, *.bilivideo.cn, *.mcdn.bilivideo.cn
block-quic = all-proxy
debug-cpu-usage = false
debug-memory-usage = false
disable-geoip-db-auto-update = false
dns-server = 119.29.29.29, 223.5.5.5, 114.114.114.144, 180.76.76.76, 1.2.4.8, system
encrypted-dns-follow-outbound-mode = true
# encrypted-dns-server = https://261860.alidns.com/dns-query, https://doh.pub/dns-query, https://doh.360.cn/dns-query, https://dns.cfiec.net/dns-query
encrypted-dns-skip-cert-verification = false
exclude-simple-hostnames = true
external-controller-access = {name}@0.0.0.0:6170
force-http-engine-hosts = *.ott.cibntv.net, 123.59.31.1, 119.18.193.135, 122.14.246.33, 175.102.178.52, *.api.mgtv.com, *.ott.cibntv.net, *.iqiyi.com
gateway-restricted-to-lan = true
geoip-maxmind-url = https://github.com/soffchen/GeoIP2-CN/raw/release/Country.mmdb
hijack-dns = *:53, 8.8.8.8, 8.8.4.4
http-api = {name}@127.0.0.1:6171
http-api-tls = false
http-api-web-dashboard = true
icmp-forwarding = true
internet-test-url = http://wifi.vivo.com.cn/generate_204
ipv6 = true
ipv6-vif = auto
loglevel = notify
proxy-restricted-to-lan = true
proxy-test-udp = apple.com@8.8.8.8
proxy-test-url = http://cp.cloudflare.com/generate_204
show-error-page = true
show-error-page-for-reject = true
skip-proxy = 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 169.254.0.0/16, 127.0.0.1/32, ::1/128, fe80::/10, fc00::/7, fd00::/8, localhost, *.local, captive.apple.com, e.crashlytics.com, yunbusiness.ccb.com, www.abchina.com.cn, mobile-bank.psbc.com, login-service.mobile-bank.psbc.com, passenger.t3go.cn
test-timeout = 5
tun-excluded-routes = 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 255.255.255.255/32, 100.64.0.0/10, 127.0.0.0/8, 169.254.0.0/16, 192.0.0.0/24, 192.0.2.0/24, 192.88.99.0/24, 198.51.100.0/24, 203.0.113.0/24, 224.0.0.0/4, ::1/128, fe80::/10, fc00::/7, fd00::/8, ff00::/8
tun-included-routes = 172.31.254.12/32, 240e:123:4567:abcd::12/128
udp-policy-not-supported-behaviour = REJECT
udp-priority = false
use-local-host-item-for-proxy = true
# ---↓---↓--- iOS only ---↓---↓--- #
all-hybrid = false
allow-hotspot-access = false
allow-wifi-access = false
auto-suspend = true
compatibility-mode = 0
hide-vpn-icon = false
include-all-networks = false
include-apns = false
include-cellular-services = false
include-local-networks = false
wifi-access-http-auth = {name}:{password}
wifi-access-http-port = 6152
wifi-access-socks5-port = 6153
wifi-assist = false
# ---↑---↑--- iOS only ---↑---↑--- #
# ---↓---↓---macOS only---↓---↓--- #
# http-listen = 0.0.0.0:6152
read-etc-hosts = true
# set-system-socks-proxy = true
# socks5-listen = 0.0.0.0:6153
subnet-exp-wifi-always-match = true
# ---↑---↑---macOS only---↑---↑--- #

[Ponte]
server-proxy-name= SS+TLS
client-proxy-name= SS+TLS

[Proxy]
#!include Privacy/Proxy.ini

[Proxy Group]
GLOBAL = select, HK, JP, US, SG, TW, UN, SS+TLS, DIRECT, Proxies
Telegram = select, SG, GLOBAL, HK, JP, US, TW
AI = select, US, GLOBAL, HK, JP, SG, TW
VPS = select, GLOBAL, HK, JP, US, SG, TW, DIRECT
Emby = select, DIRECT, 实验线路0.2X, SS+TLS, GLOBAL
Apple = select, DIRECT, HK, JP, US, SG, TW
OneDrive = select, DIRECT, GLOBAL
Speedtest = select, DIRECT, HK, JP, US, SG, TW, UN, SS+TLS, 高级线路, 标准线路, 实验线路0.2X, Proxies
Final = select, DIRECT, GLOBAL, REJECT
UN = select, policy-regex-filter=^(?!.*?(香港|日本|新加坡|美国|台湾|实验)).*(标准), include-other-group=Proxies, hidden=1
HK = smart, policy-regex-filter=香港, include-other-group=Proxies, hidden=1
JP = smart, policy-regex-filter=日本, include-other-group=Proxies, hidden=1
US = smart, policy-regex-filter=美国, include-other-group=Proxies, hidden=1
SG = smart, policy-regex-filter=新加坡, include-other-group=Proxies, hidden=1
TW = smart, policy-regex-filter=台湾, include-other-group=Proxies, hidden=1
高级线路 = select, policy-regex-filter=高级, include-other-group=Proxies, hidden=1
标准线路 = select, policy-regex-filter=标准, include-other-group=Proxies, hidden=1
实验线路0.2X = select, policy-regex-filter=实验, include-other-group=Proxies, hidden=1
Proxies = select, policy-path={url}

[Rule]
# 白名单
DOMAIN,update.code.visualstudio.com,DIRECT // VSCode更新
DOMAIN-SUFFIX,msecnd.net,DIRECT // VSCode更新
DOMAIN-SUFFIX,rztcd.com,DIRECT // 蓉政通
DOMAIN-SUFFIX,cddyjy.com,DIRECT // 蓉城先锋
DOMAIN-SUFFIX,bendibao.com,DIRECT // 成都本地宝
DOMAIN-SUFFIX,cdrcbank.com,DIRECT // 成都农商银行
DOMAIN-SUFFIX,splashtop.com,DIRECT // Splashtop
# 黑名单
DOMAIN,connect.garmin.com,GLOBAL // 佳明国际账号
DOMAIN,sso.garmin.com,GLOBAL // 佳明国际账号
DOMAIN-SUFFIX,mailjet.com,GLOBAL // 邮件发送服务
DOMAIN-SUFFIX,proton.me,GLOBAL // 加密邮箱
DOMAIN-SUFFIX,oplist.org,GLOBAL // openlist
DOMAIN-SUFFIX,openlist.team,GLOBAL // openlist
DOMAIN-SUFFIX,readest.com,GLOBAL // readest
DOMAIN-SUFFIX,mcp.so,GLOBAL // MCP库
DOMAIN-SUFFIX,nsloon.app,GLOBAL
DOMAIN-SUFFIX,kelee.one,GLOBAL // 可莉插件
DOMAIN-SUFFIX,annas-archive.org,GLOBAL // 安妮的档案
DOMAIN-SUFFIX,firefly-iii.org,GLOBAL // 开源财务系统
DOMAIN-SUFFIX,allinhub.dpdns.org,GLOBAL // 个人网址
DOMAIN-SUFFIX,amysecure.com,GLOBAL // AmyTelecom官网
DOMAIN-SUFFIX,paopao.dog,GLOBAL // 泡泡狗官网
DOMAIN-SUFFIX,api-flowercloud.com,GLOBAL // 花云官网
DOMAIN-SUFFIX,rutracker.org,GLOBAL // 俄罗斯crash网站
DOMAIN-SUFFIX,linux.do,GLOBAL // 秦始皇论坛
# Emby
DOMAIN-SUFFIX,uhdnow.com,Emby // UHD影视
# JavBus
DOMAIN-SUFFIX,dmm.co.jp,JP
DOMAIN-SUFFIX,mgstage.com,JP
DOMAIN-SUFFIX,javbus.com,GLOBAL
DOMAIN-SUFFIX,javbus22.com,GLOBAL
DOMAIN-SUFFIX,missav.com,GLOBAL
DOMAIN-SUFFIX,eightcha.com,GLOBAL
DOMAIN-SUFFIX,javdb.com,GLOBAL
DOMAIN-SUFFIX,jable.tv,GLOBAL
DOMAIN-SUFFIX,avgle.com,GLOBAL
DOMAIN-SUFFIX,javlibrary.com,GLOBAL
DOMAIN-SUFFIX,jav.guru,GLOBAL
DOMAIN-SUFFIX,netflav.com,GLOBAL
DOMAIN-SUFFIX,javday.tv,GLOBAL
# > VPS
IP-CIDR,130.162.131.186/32,VPS,no-resolve // OraclARM
# > AI
RULE-SET,https://kelee.one/Tool/Loon/Lsr/AI.lsr,AI,no-resolve
# 局域网
RULE-SET,https://rule.kelee.one/Loon/Lan.lsr,DIRECT,no-resolve
# 后续规则修正
RULE-SET,https://rule.kelee.one/Loon/Direct.lsr,DIRECT,no-resolve
# Bing
RULE-SET,https://rule.kelee.one/Loon/Bing.lsr,DIRECT,no-resolve
# Apple
RULE-SET,https://rule.kelee.one/Loon/Apple.lsr,Apple,no-resolve
# Onedrive
RULE-SET,https://rule.kelee.one/Loon/OneDrive.lsr,OneDrive,no-resolve
# GoogleVoice
RULE-SET,https://rule.kelee.one/Loon/GoogleVoice.lsr,US,no-resolve
# Telegram
RULE-SET,https://rule.kelee.one/Loon/Telegram.lsr,Telegram,no-resolve
# Speedtest
RULE-SET,https://kelee.one/Tool/Loon/Lsr/SpeedtestChina.lsr,Speedtest,no-resolve
RULE-SET,https://kelee.one/Tool/Loon/Lsr/SpeedtestInternational.lsr,Speedtest,no-resolve
# 微信
RULE-SET,https://rule.kelee.one/Loon/WeChat.lsr,DIRECT,no-resolve
# China
RULE-SET,https://rule.kelee.one/Loon/IPTVMainland.lsr,DIRECT,no-resolve
RULE-SET,https://rule.kelee.one/Loon/ChinaMax.lsr,DIRECT,no-resolve
# GLOBAL
RULE-SET,https://rule.kelee.one/Loon/IPTVOther.lsr,GLOBAL,no-resolve
RULE-SET,https://rule.kelee.one/Loon/Global.lsr,GLOBAL,no-resolve
FINAL,Final,dns-failed

[Host]
# Fuck Telegram bad ips
91.108.56.100 = 91.108.56.147, 91.108.56.135, 91.108.56.130
91.108.56.101 = 91.108.56.147, 91.108.56.135, 91.108.56.130
91.108.56.104 = 91.108.56.147, 91.108.56.135, 91.108.56.130
91.108.56.107 = 91.108.56.147, 91.108.56.135, 91.108.56.130
91.108.56.125 = 91.108.56.147, 91.108.56.135, 91.108.56.130
91.108.56.126 = 91.108.56.147, 91.108.56.135, 91.108.56.130
91.108.56.128 = 91.108.56.147, 91.108.56.135, 91.108.56.130
91.108.56.156 = 91.108.56.147, 91.108.56.135, 91.108.56.130
# 91.108.56.* = 91.108.56.147
# 改善App Store下载速度
iosapps.itunes.apple.com = iosapps.itunes.apple.com.download.ks-cdn.com
# 改善系统升级下载速度
updates.g.aaplimg.com = updates.cdn-apple.com.download.ks-cdn.com

[URL Rewrite]
# 修复RssHub设置key后浏览器插件无法更新问题
^https:\/\/rsshub\.allinhub\.dpdns\.org\/api\/radar\/rules$ "https://rsshub.allinhub.dpdns.org/api/radar/rules?code=cf50040e5b2c8236327b7a0de38a29dd" 302
# 以下为Safari全能搜索、需要把Safari的搜索引擎设置为：DuckDuckGo或自定义搜索引擎为https://duckduckgo.com/?q=%s
# (Google图片)gm
"^https:\/\/duckduckgo.com\/\?q=([^&]+)\+gm" "https://www.google.com/search?&tbm=isch&q=$1" 302
# (GitHub)gh
"^https:\/\/duckduckgo.com\/\?q=([^&]+)\+gh" "https://github.com/search?q=$1" 302
# (Google 搜索 TestFlight)tf
"^https:\/\/duckduckgo.com\/\?q=([^&]+)(\+|%20)tf" "https://www.google.com/search?as_q=$1&as_sitesearch=testflight.apple.com" 302
# (微博)wb
"^https:\/\/duckduckgo.com\/\?q=([^&]+)\+wb" https://s.weibo.com/weibo/$1 302
# (微信)wx
"^https:\/\/duckduckgo.com\/\?q=([^&]+)\+wx" "https://weixin.sogou.com/weixinwap?query=$1" 302
# (京东)jd
"^https:\/\/duckduckgo.com\/\?q=([^&]+)\+jd" "https://so.m.jd.com/ware/search.action?keyword=$1" 302
# (淘宝)tb
"^https:\/\/duckduckgo.com\/\?q=([^&]+)\+tb" "https://s.taobao.com/search?q=$1" 302
# (天猫)tm
"^https:\/\/duckduckgo.com\/\?q=([^&]+)\+tm" "https://s.m.tmall.com/m/search.htm?q=$1" 302
# (YouTube)ytb
"^https:\/\/duckduckgo.com\/\?q=([^&]+)\+ytb" "https://www.youtube.com/results?search_query=$1" 302
# (PornHub)ph
"^https:\/\/duckduckgo.com\/\?q=([^&]+)\+ph" "https://cn.pornhub.com/video/search?search=$1" 302
# (Goolge)gg
"^https:\/\/duckduckgo.com\/\?q=([^&]+)\+gg" "https://www.google.com/search?q=$1" 302
# (百度)bd
"^https:\/\/duckduckgo.com\/\?q=([^&]+)\+bd" "https://www.baidu.com/s?wd=$1" 302
# (DuckDuckGo)ddg
"^https:\/\/duckduckgo.com\/\?q=([^&]+)\+ddg" "https://duckduckgo.com/?ia=about&q=$1" 302
# (Bing)无指令
"^https:\/\/duckduckgo.com\/\?q=([^&]+)" "https://www.bing.com/search?q=$1" 302

[Header Rewrite]
# 解除 Github 429 限制
#http-request ^https:\/\/github\.com\/ header-replace Accept-Language en-us
#http-request ^https:\/\/(raw|gist)\.githubusercontent\.com\/ header-replace Accept-Language en-us
# 修复少数派 RSS 图片 CDN
http-request ^https?:\/\/cdnfile\.sspai\.com\/.+\.(jpg|jpeg|gif|png|webp)$ header-del Referer
http-request ^https?:\/\/cdnfile\.sspai\.com\/.+\.(jpg|jpeg|gif|png|webp)$ header-add Referer https://sspai.com/
http-request ^https?:\/\/cdnfile\.sspai\.com\/.+\.(jpg|jpeg|gif|png|webp)$ header-del Dnt
http-request ^https?:\/\/cdnfile\.sspai\.com\/.+\.(jpg|jpeg|gif|png|webp)$ header-add Dnt 1
# 修复可莉资源访问权限
http-response ^https:\/\/(rule\.)?kelee\.one(?:\/.*)?$ header-add content-disposition inline
http-response ^https:\/\/(rule\.)?kelee\.one(?:\/.*)?$ header-replace content-type "text/plain; charset=utf-8"
http-request ^https:\/\/(rule\.)?kelee\.one(?:\/.*)?$ header-replace User-Agent "Surge iOS/3573"
http-request ^https:\/\/(plugin)?hub\.kelee\.one(?:\/.*)?$ header-del content-disposition
http-request ^https:\/\/(plugin)?hub\.kelee\.one(?:\/.*)?$ header-del if-none-match
http-request ^https:\/\/(plugin)?hub\.kelee\.one(?:\/.*)?$ header-replace cache-control no-cache
# 简易鉴权
http-request ^https?:\/\/scripthub\.allinhub\.dpdns\.org(?:\/.*)?$ header-add X-Auth-Token {X-Auth-Token}

[Body Rewrite]
# 地震预警FakeVIP
http-response-jq ^https?:\/\/mobile-new\.chinaeew\.cn\/v1\/order\/apple\/vip$ '.data.productName = "SVIP" | .data.endTime = 4791705729000 | .data.vipType = "svip" | .data.productId = "earthquake_early_warning_SVIP" | .data.upgradePrice = 0' #!IOS-ONLY
# 取消可莉插件中心跳转 Loon 安装
http-response ^https:\/\/(plugin)?hub\.kelee\.one/list\.json$ "loon:\/\/import\?plugin=(https:\/\/kelee\.one\/Tool\/Loon\/Lpx\/([^\/]+))\.lpx" "https://scripthub.allinhub.dpdns.org/file/_start_/$1.lpx/_end_/$2.sgmodule?type=loon-plugin&target=surge-module&del=true&jqEnabled=true&category=iKelee"

[SSID Setting]
# SSID:{wifi} tfo-behaviour=force-enabled, cellular-fallback=off, dns-server="119.29.29.29", encrypted-dns-server="https://261860.alidns.com/dns-query"

[MITM]
h2 = true
hostname = api.jzznck.com:8080, mobile-new.chinaeew.cn, *.githubusercontent.com, github.com, cdnfile.sspai.com, *kelee.one, duckduckgo.com, *allinhub.dpdns.org, -p7-buy.itunes.apple.com, -buy.itunes.apple.com, -api.revenuecat.com
# client-source-address =
ca-keystore-name = Bughub

[Script]
# 电瓶车车库开门,微信内打开http://www.jzznck.com/QRCode/Scann/d100187_123323073_1_1获取access_token，之后通过opendoor脚本开门
opendoor = type=cron,cronexp=15 7 * * *,script-path=JS/opendoor.js #!IOS-ONLY
dooropen = type=cron,cronexp=60 7 * * *,script-path=JS/dooropen.js #!IOS-ONLY
doortoken = type=http-response,pattern=http:\/\/api\.jzznck\.com:8080\/api\/passport\/sso\/WeChatAuthorize$,requires-body=1,script-path=JS/doortoken.js #!IOS-ONLY
# 每日机场流量
getinfo = type=cron,cronexp=58 16 * * *,script-path=JS/getinfo.js #!IOS-ONLY
# 自建服务转本地服务
localserver = type=http-request,pattern=^https:\/\/openlist\.allinhub\.dpdns\.org(?:\/.*)?$,script-path=JS/localserver.js

[Keystore]
#!include Privacy/Keystore.ini

[WireGuard Cloudflare]
#!include Privacy/WARP.ini
